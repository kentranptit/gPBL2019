B<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use Illuminate\Support\Facades\DB;
use App\Models\Employee;
use App\Models\Leave;

class VisualizationController extends Controller
{
    //
    public function index()
    {
        $resignedEmp = DB::table('employees')
                    ->join('leaves','employees.employee_number','=','leaves.employee_number')
                    ->get();
        $male = 0;
        $female = 0;
        $maleper = 0;
        $femaleper = 0;
        foreach($resignedEmp as $emp) {
            if ($emp->gender == 'Male')
                $male++;
            else if ($emp->gender == 'Female')
                $female++;
        }
        $maleper = $male*100/($male + $female);
        $femaleper = $female*100/($male + $female);
        return view('employee.index', ['resignedEmp' => $resignedEmp,
                                       'maleper' => $maleper,
                                       'femaleper' => $femaleper]);
    }
}
